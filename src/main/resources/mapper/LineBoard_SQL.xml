<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.testspring.test17.web.lineBoard.DAO.ILineBoardDao">
    <select id="getBoardCnt" parameterType="hashmap" resultType="Integer">
        SELECT COUNT(*) AS CNT
        FROM O1
        WHERE 1=1
    </select>

    <select id="boardList" parameterType="HashMap" resultType="LineBoardDTO">
        SELECT O.O_NO AS O_NO
             , O.CON AS O_CON
             , O.M_NM AS M_NM
             , O.M_NO AS M_NO
             , DATE_FORMAT(O.DT, '%Y-%m-%d %H:%i %p') AS DT
        FROM (SELECT O1.O_NO AS O_NO
                   , O1.CON AS CON
                   , O1.M_NO AS M_NO
                   , O1.O_DT AS DT
                   , M1.M_NM AS M_NM
                   , ROW_NUMBER() OVER(ORDER BY O_NO DESC) RNUM
              FROM M1
                       JOIN O1 ON M1.M_NO = O1.M_NO
              WHERE 1 = 1
             ) O
        WHERE O.RNUM BETWEEN #{startCnt} AND #{endCnt}
    </select>
    <select id="getLogin" parameterType="hashmap" resultType="lineBoardDTO">
        SELECT m_no, m_nm
        FROM m1
        WHERE m_id = #{m_id}
          AND m_pw = #{m_pw}
    </select>
    <insert id="addLineBoard" parameterType="hashmap">
        INSERT INTO O1(m_no, con)
        VALUES (#{m_no}, #{write_con})
    </insert>

    <delete id="deleteLineBoard" parameterType="hashmap">
        DELETE FROM O1
        WHERE o_no = #{no}
    </delete>

    <update id="updateLineBoard" parameterType="hashmap">
        UPDATE O1 SET con = #{write_con}
        WHERE O_NO = #{no}
    </update>
</mapper>